<%- include('header.ejs') %>
<style>
  /* General styles */
  body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
  }

  .shop-top-bar {
    display: flex;
    flex-wrap: wrap; /* Allows wrapping for smaller screens */
    gap: 10px; /* Adds space between elements */
    padding: 10px;
  }

  .shop-tab,
  .shop-filter,
  .shop-short-by,
  form {
    margin: 5px 0; /* Adds spacing for individual elements */
  }

  /* Filter Modal */
  #filterModal {
    display: none; /* Hidden by default */
  }

  /* Responsive Styles */

  /* For small screens (up to 768px) */
  @media (max-width: 768px) {
    .shop-top-bar {
      flex-direction: column; /* Stack elements vertically */
      align-items: center; /* Center-align content */
    }

    .shop-filter,
    .shop-short-by,
    form {
      width: 100%; /* Make elements full-width */
    }

    #filterModal div {
      max-width: 90%; /* Shrink modal width for smaller screens */
    }
  }

  /* For medium screens (769px to 991px) */
  @media (min-width: 769px) and (max-width: 991px) {
    .shop-top-bar {
      flex-direction: row; /* Display elements in a row */
      justify-content: space-evenly; /* Even spacing */
    }

    .shop-filter,
    .shop-short-by {
      flex: 1; /* Equal width for filter and sort options */
    }

    #filterModal div {
      max-width: 80%; /* Adjust modal size */
    }
  }

  /* For large screens (992px and above) */
  @media (min-width: 992px) {
    .shop-top-bar {
      justify-content: space-between; /* Space out elements */
    }

    .shop-filter,
    .shop-short-by {
      margin: 0 10px; /* Add horizontal spacing */
    }

    #filterModal div {
      max-width: 600px; /* Default modal width for large screens */
    }
  }
</style>

<style>
  body{
   background-color:  #f3f3eb
  }
</style>

    <style>
      /* Customizing checkbox appearance */
input[type="checkbox"] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  border: 2px solid #ccc; /* Border color */
  border-radius: 4px; /* Rounded corners */
  cursor: pointer;
  position: relative;
}

input[type="checkbox"]:checked {
  background-color: #fc4f4f; /* Green color when checked */
  border-color:#fc4f4f; /* Border color when checked */
}

input[type="checkbox"]:checked::before {
  content: '✔'; /* Checkmark symbol */
  position: absolute;
  top: -1px;
  left: 5px;
  color: white; /* Checkmark color */
  font-size: 14px;
}

    </style>
    

     
      <!-- search start -->
      <div class="search-content-wrap main-search-active">
        <a class="search-close"><i class="dlicon ui-1_simple-remove"></i></a>
        <div class="search-content">
          <p>Start typing and press Enter to search</p>
          <form class="search-form" action="#">
            <input type="text" placeholder="Search" />
            <button class="button-search">
              <i class="dlicon ui-1_zoom"></i>
            </button>
          </form>
        </div>
      </div>
      <!-- mini cart start -->
      <div class="sidebar-cart-active">
        <div class="sidebar-cart-all">
          <a class="cart-close" href="#"
            ><i class="dlicon ui-1_simple-remove"></i
          ></a>
          <div class="cart-content">
            <h3>Shopping Cart</h3>
            <ul>
              <li class="single-product-cart">
                <div class="cart-img">
                  <a href="#"
                    ><img src="/assets/images/cart/cart-1.jpg" alt=""
                  /></a>
                </div>
                <div class="cart-title">
                  <h4><a href="#">Bejewelled velvet sandals</a></h4>
                  <span> 1 × ₹49.00 </span>
                </div>
                <div class="cart-delete">
                  <a href="#">×</a>
                </div>
              </li>
              <li class="single-product-cart">
                <div class="cart-img">
                  <a href="#"
                    ><img src="/assets/images/cart/cart-2.jpg" alt=""
                  /></a>
                </div>
                <div class="cart-title">
                  <h4><a href="#">Contrast faux fur jacket</a></h4>
                  <span> 1 × ₹49.00 </span>
                </div>
                <div class="cart-delete">
                  <a href="#">×</a>
                </div>
              </li>
            </ul>
            <div class="cart-total">
              <h4>Subtotal: <span>₹170.00</span></h4>
            </div>
            <div class="cart-checkout-btn">
              <a class="btn-hover cart-btn-style" href="cart.html">view cart</a>
              <a class="no-mrg btn-hover cart-btn-style" href="checkout.html"
                >checkout</a
              >
            </div>
          </div>
        </div>
      </div>
      <!-- aside start -->
      
      <!-- <div
        class="breadcrumb-area section-padding-1 breadcrumb-bg-1 breadcrumb-ptb-2"
      >
        <div class="container-fluid">
          <div class="breadcrumb-content text-center">
            <div class="breadcrumb-title">
              <h2>Shop Sidebar</h2>
            </div>
            <ul>
              <li>
                <a href="index.html">Home 01 </a>
              </li>
              <li><span> &gt; </span></li>
              <li class="active">shop</li>
            </ul>
          </div>
        </div>
      </div> -->










      <div
  class="breadcrumb-area section-padding-1 breadcrumb-bg-1 breadcrumb-ptb-2"
  style="background-image: url('http://localhost:3700//assets/images/bg/breadcrumb-bg-1.jpg'); 
         width: 100%; 
         max-width: 1880px; 
         height: 400px; 
         background-size: cover; 
         background-position: center; 
         background-repeat: no-repeat; 
         margin: 0 auto;"
>
  <div class="container-fluid">
    <div class="breadcrumb-content text-center">
      <div class="breadcrumb-title">
        <h2>Shop Sidebar</h2>
      </div>
      <ul>
        <li>
          <a href="index.html">Home 01</a>
        </li>
        <li><span> &gt; </span></li>
        <li class="active">shop</li>
      </ul>
    </div>
  </div>
</div>
<br>
   
            <div >
              <div class="shhop-pl-35">











                <div >
                  <div class="shop-top-bar" style="display: flex !important; flex-direction: row !important; justify-content: space-evenly !important;">
                 
                   
                    
                    <div class="shop-top-bar-right">
                      <div class="shop-tab nav">
                        <a href="#shop-1" class="active" data-bs-toggle="tab">
                          <i class="dlicon ui-2_grid-45"></i>
                        </a>
                        <a href="#shop-2" data-bs-toggle="tab">
                          <i class="dlicon design_bullet-list-69"></i>
                        </a>
                      </div>
                      
                    
  
                   <!-- Trigger for Modal -->
  <div class="shop-filter ml-50">
    <a 
      class="shop-filter-active" 
      href="javascript:void(0)" 
      onclick="toggleModal()" 
      style="display: flex; align-items: center; cursor: pointer; text-decoration: none; color: #333;">
      Filters 
      <i class="fa fa-angle-down" style="margin-left: 5px;"></i>
    </a>
  </div>
  
  <!-- Modal Structure -->
  <div 
    id="filterModal" 
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 9999; overflow-y: auto;">
    <div 
      style="position: relative; margin: 50px auto; max-width: 600px; background-color: #ececec; border-radius: 10px; padding: 20px; box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);">
      <!-- Close Button -->
      <button 
        onclick="toggleModal()" 
        style="position: absolute; top: 10px; right: 10px; background: transparent; border: none; font-size: 20px; cursor: pointer;">
        &times;
      </button>
  
      <!-- Filter Options -->
      <form action="/product" method="GET" style="margin: 0;">
        <h2 style="text-align: center; margin-bottom: 20px;">Filter by Category</h2>
        <div style="max-height: 400px; overflow-y: auto; padding: 10px;">
          <% categories.forEach(cat => { %>
            <div style="margin-bottom: 15px; display: flex; align-items: center;">
              <input  
              
                type="checkbox" 
                name="categories" 
                value="<%= cat._id %>" 
                <%= Array.isArray(selectedCategories) && selectedCategories.includes(cat._id.toString()) ? 'checked' : '' %> 
                style="margin-right: 10px; width:20px" 
              />
       
  
              <label style="font-size: 16px; color: #333;"><%= cat.name %></label>
            </div>
          <% }) %>
        </div>
        <div style="text-align: center; margin-top: 20px;">
          <button 
            type="submit" 
            style="padding: 10px 20px; font-size: 16px; color: #fff; background-color: #fc4f4f; border: none; border-radius: 5px; cursor: pointer;">
            Apply Filters
          </button>
        </div>
      </form>
    </div>
  </div>
  
                      
                      <div class="shop-short-by ml-50">
                        <label for="sort-options">Sort by:</label>
                        <select id="sort-options">
                          <option value="default">Default sorting</option>
                          <option value="a-z">Sort by name: A-Z</option>
                          <option value="z-a">Sort by name: Z-A</option>
                          <option value="low-to-high">Sort by price: low to high</option>
                          <option value="high-to-low">Sort by price: high to low</option>
                        </select>
                      </div>
                    </div>
                      <!-- <div style="margin-right: 23px;">
                        <form action="/search" method="GET" style="display: flex; align-items: center; width: 100%; max-width: 600px; margin: 0 auto ; margin-top: 26px;">
                          <input 
                            type="text" 
                            name="query" 
                            placeholder="Search..." 
                            style="width: 100%; padding: 10px; border: 1px solid black; background-color: white; font-size: 16px; border-radius: 4px; outline: none; box-sizing: border-box;">
                          <button 
                            type="submit" 
                            style="padding: 10px 15px; border: 1px solid black; background-color: white; color: black; font-size: 16px; cursor: pointer; border-radius: 4px; margin-left: 5px;">
                            <i class="dlicon ui-1_zoom"></i>
                          </button>
                        </form>
                      </div> -->
                    <!-- Search Form -->
  <div style="margin-right: 23px;">
    <form action="/product" method="GET" style="display: flex; align-items: center; width: 100%; max-width: 600px; margin: 0 auto ; margin-top: 26px;">
      <!-- Search Input -->
      <input 
        type="text" 
        name="query" 
        placeholder="Search..." 
        value="<%= searchQuery %>"  
        style="width: 100%; padding: 10px; border: 1px solid black; background-color: transparent; font-size: 16px; border-radius: 4px; outline: none; box-sizing: border-box;">
      
      <!-- Search Button -->
      <button 
        type="submit" 
        style="padding: 10px 15px; border: 1px solid black; background-color: transparent; color: black; font-size: 16px; cursor: pointer; border-radius: 4px; margin-left: 5px;">
        <i class="dlicon ui-1_zoom"></i>
      </button>
    </form>
  </div>
  <!-- Display Products -->
  
  
                  </div>
                </div>
                <br><br><br>
                <div class="tab-content jump-3 pt-30">
                  <div id="shop-1" class="tab-pane active">
                    <div class="row" id="product-list" style="justify-content: space-evenly;  display: flex; flex-wrap: wrap;">
                      <% if (product.length > 0 ) { %>
                        <% for (let i = 0; i < product.length; i++) { %>
                         <% if(product[i].isListed){ %>
                          <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6" style="display: flex; justify-content: center;">
                            <div class="product-wrap mb-50" style="width: 333px; display: flex; flex-direction: column;">
                              <div class="product-img default-overlay mb-25">
                                <a href="/product-details/<%= product[i]._id %>">
                                  <img class="default-img" src="/uploads/<%= product[i].image_url[0] %>" alt="<%= product[i].product_title %>" />
                                  <img class="hover-img" src="/uploads/<%= product[i].image_url[1] %>" alt="Hover image for <%= product[i].product_title %>" />
                                </a>
                                <div class="product-action product-action-position-1">
                                
                                </div>
                              </div>
                              <div class="product-content-2 title-font-width-400 text-center">
                                <h3><a href="/product-details/<%= product[i]._id %>"><%= product[i].product_title %></a></h3>
                                <div class="product-price">
                                  <% if (product[i].discountedPrice) { %>
                                    <% console.log("hy");
                                     %>
                                    <span class="original-price" style="text-decoration: line-through; color: grey;">
                                      ₹<%= product[i].price.toFixed(2) %>
                                    </span>
                                    <span class="new-price" style="color: green; font-weight: bold;">
                                      ₹<%= product[i].discountedPrice.toFixed(2) %>
                                    </span>
                                  <% } else { %>
                                    <span class="new-price">₹<%= product[i].price.toFixed(2) %></span>
                                  <% } %>
                                </div>
                              </div>
                            </div>
                          </div>
                          <% } %>
                        <% } %>
                      <% } else { %>
                        <p>No products available.</p>
                      <% } %>
                    </div>
                    
                  </div>
                </div>
                
              </div>
            </div>
        
           
            <div id="footer-container">
              <%- include('footer') %>
            </div>
      <div class="support-lists">
        <ul>
          <li>
            <a href="#"><i class="dlicon ui-3_chat-46"></i></a>
          </li>
          <li>
            <a href="#"><i class="dlicon ui-3_phone"></i></a>
          </li>
          <li>
            <a href="#"><i class="dlicon ui-1_email-85"></i></a>
          </li>
        </ul>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button
                type="button"
                class="close"
                data-bs-dismiss="modal"
                aria-label="Close"
              >
                <span
                  class="dlicon ui-1_simple-remove"
                  aria-hidden="true"
                ></span>
              </button>
            </div>
            <div class="modal-body">
              <div class="row g-0">
                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                  <div class="quickview-slider-active owl-carousel">
                    <a
                      class="img-popup"
                      href="/assets/images/product/quickview-1.jpg"
                      ><img
                        src="/assets/images/product/quickview-1.jpg"
                        alt=""
                      /><span>sold uot</span></a
                    >
                    <a
                      class="img-popup"
                      href="/assets/images/product/quickview-2.jpg"
                      ><img
                        src="/assets/images/product/quickview-2.jpg"
                        alt=""
                      /><span>sold uot</span></a
                    >
                  </div>
                  <!-- Thumbnail Large Image End -->
                </div>
                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                  <div class="product-details-content">
                    <div class="pro-dec-next-prev">
                      <a class="prev" href="#"
                        ><i class="dlicon arrows-1_tail-left"></i
                      ></a>
                      <a class="next" href="#"
                        ><i class="dlicon arrows-1_tail-right"></i
                      ></a>
                    </div>
                    <h2 class="uppercase">Quilted parka with hood</h2>
                    <h3>₹49.00</h3>
                    <div class="product-details-peragraph">
                      <p>
                        Donec accumsan auctor iaculis. Sed suscipit arcu ligula,
                        at egestas magna molestie a. Proin ac ex maximus,
                        ultrices justo eget, sodales orci. Aliquam libero ac
                        turpis pharetra, in vehicula scelerisque. Vestibulum ut
                        sem laoreet, feugiat tellus at, hendrerit arcu.
                      </p>
                    </div>
                    <div class="product-details-action-wrap">
                      <div class="product-details-quality">
                        <div class="cart-plus-minus">
                          <input
                            class="cart-plus-minus-box"
                            type="text"
                            name="qtybutton"
                            value="2"
                          />
                        </div>
                      </div>
                      <div class="product-details-cart">
                        <a title="Add to cart" href="#">Add to cart</a>
                      </div>
                      <div class="product-details-wishlist">
                        <a title="Add to wishlist" href="#"
                          ><i class="fa fa-heart"></i
                        ></a>
                      </div>
                      <div class="product-details-compare">
                        <a title="Add to compare" href="#"
                          ><i class="dlicon arrows-4_compare"></i
                        ></a>
                      </div>
                    </div>
                    <div class="product-details-info">
                      <a href="#"
                        ><i class="dlicon location_pin"></i>Store
                        availability</a
                      >
                      <a href="#"
                        ><i class="dlicon envir_car"></i>Delivery and return</a
                      >
                      <a href="#"
                        ><i class="dlicon design_measure-17"></i>Size Guide</a
                      >
                    </div>
                    <div class="product-details-meta">
                      <span>SKU: REF. LA-140</span>
                      <span
                        >Categories: <a href="#">Fashions</a>,
                        <a href="#">Main 01</a>, <a href="#">Main 02</a></span
                      >
                      <span
                        >Tags: <a href="#">Blazer</a>, <a href="#">chair</a>,
                        <a href="#">Coat</a>, <a href="#">dress</a>,
                        <a href="#">light</a>, <a href="#">Living</a>,
                        <a href="#">Main 01</a></span
                      >
                    </div>
                    <div class="social-icon-style-3">
                      <a class="facebook" href="#"
                        ><i class="fa fa-facebook"></i
                      ></a>
                      <a class="twitter" href="#"
                        ><i class="fa fa-twitter"></i
                      ></a>
                      <a class="linkedin" href="#"
                        ><i class="fa fa-linkedin"></i
                      ></a>
                      <a class="pinterest" href="#"
                        ><i class="fa fa-pinterest-p"></i
                      ></a>
                      <a class="google-plus" href="#"
                        ><i class="fa fa-google-plus"></i
                      ></a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Modal end -->
    </div>

    <!-- All JS is here
============================================ -->



<script>
  function toggleFilter() {
    const filterOptions = document.querySelector('.filter-options');
    const angleDown = document.querySelector('.angle-down');
    const angleUp = document.querySelector('.angle-up');

    if (filterOptions.style.display === 'none' || filterOptions.style.display === '') {
      filterOptions.style.display = 'block';
      angleDown.style.display = 'none';
      angleUp.style.display = 'inline-block';
    } else {
      filterOptions.style.display = 'none';
      angleDown.style.display = 'inline-block';
      angleUp.style.display = 'none';
    }
  }
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const sortDropdown = document.getElementById("sort-options");

    sortDropdown.addEventListener("change", function () {
      const sortType = this.value;

      fetch("/sort-products", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ sortType }),
      })
        .then((response) => {
          if (!response.ok) throw new Error("Failed to sort products");
          return response.json();
        })
        .then((data) => {
          console.log("Sorted products:", data.sortedProducts);
          updateProductList(data.sortedProducts);
        })
        .catch((error) => {
          console.error("Error sorting products:", error);
        });
    });
  });

  function updateProductList(products) {
    console.log(products);

    const productList = document.getElementById("product-list");
    productList.innerHTML = "";

    if (products.length > 0) {
      products.forEach((product) => {
        const productItem = document.createElement("div");
        productItem.className = "col-xl-4 col-lg-6 col-md-6 col-sm-6" ;
        if (!product.isListed) {
          return; // Skip the product if it's not listed
        }
        // Default price (if no discount)
        let priceHTML = `<span class="new-price">₹${product.price}</span>`;

        // Check if discountedPrice exists
        if (product.discountedPrice) {
          priceHTML = `
            <span class="old-price" style="text-decoration: line-through;">₹${product.price}</span>
            <span class="new-price" style="color: green;">₹${product.discountedPrice}</span>
          `;
        }

        productItem.innerHTML = `
          <div class="product-wrap mb-50" style="
    width: 333px;
" >
            <div class="product-img default-overlay mb-25">
              <a href="/product-details/${product._id}">
                <img class="default-img" src="/uploads/${product.image_url[0]}" alt="${product.product_title}" />
                <img class="hover-img" src="/uploads/${product.image_url[1]}" alt="Hover image for ${product.product_title}" />
              </a>
              <div class="product-action product-action-position-1">
              
              </div>
            </div>
            <div class="product-content-2 title-font-width-400 text-center">
              <h3>
                <a href="/product-details/${product._id}">${product.product_title}</a>
              </h3>
              <div class="product-price">
                ${priceHTML}
              </div>
            </div>
          </div>
        `;
        
        productList.appendChild(productItem);
      });
    } else {
      // Display message if no products are available
      productList.innerHTML = "<p>No products available.</p>";
    }
  }
</script>

    <script>
      function toggleModal() {
  const modal = document.getElementById('filterModal');
  if (modal.style.display === 'none' || !modal.style.display) {
    modal.style.display = 'block';
  } else {
    modal.style.display = 'none';
  }
}

    </script>
    
    <!-- Modernizer JS -->
    <script src="/assets/js/vendor/modernizr-3.11.7.min.js"></script>
    <!-- jquery -->
    <script src="/assets/js/vendor/jquery-v3.6.0.min.js"></script>
    <!-- Popper JS -->
    <script src="/assets/js/vendor/popper.js"></script>
    <!-- Bootstrap JS -->
    <script src="/assets/js/vendor/bootstrap.min.js"></script>
    <script src="/assets/js/plugins/owl-carousel.js"></script>
    <script src="/assets/js/plugins/slick.js"></script>
    <script src="/assets/js/plugins/jarallax.min.js"></script>
    <script src="/assets/js/plugins/countdown.js"></script>
    <script src="/assets/js/plugins/magnific-popup.js"></script>
    <script src="/assets/js/plugins/instafeed.js"></script>
    <script src="/assets/js/plugins/tilt.js"></script>
    <script src="/assets/js/plugins/images-loaded.js"></script>
    <script src="/assets/js/plugins/isotope.js"></script>
    <script src="/assets/js/plugins/scrolloverflow-fullpage.js"></script>
    <script src="/assets/js/plugins/fullpage.js"></script>
    <script src="/assets/js/plugins/jquery-ui.js"></script>
    <script src="/assets/js/plugins/jquery-ui-touch-punch.js"></script>
    <script src="/assets/js/plugins/easyzoom.js"></script>
    <script src="/assets/js/plugins/resizesensor.js"></script>
    <script src="/assets/js/plugins/sticky-sidebar.js"></script>
    <script src="/assets/js/plugins/scrollup.js"></script>
    <script src="/assets/js/plugins/select2.min.js"></script>
    <script src="/assets/js/plugins/cookie.js"></script>
    <script src="/assets/js/plugins/bpopup.js"></script>
    <script src="/assets/js/plugins/wow.js"></script>
    <script src="/assets/js/plugins/ajax-mail.js"></script>
    <!-- Main JS -->
    <script src="/assets/js/main.js"></script>
  </body>

  <!-- Mirrored from template.hasthemes.com/toro/toro/shop-sidebar.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 09 Feb 2024 11:19:25 GMT -->
</html>
